<!doctype html>
<html lang="en" data-bs-theme="blue-theme">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Member List - Aghan Promoters</title>
  <!--favicon-->
  <link rel="icon" href="assets/images/Logo/avatar.png" type="image/png">
  <!-- loader-->
  <link href="assets/css/pace.min.css" rel="stylesheet">
  <script src="assets/js/pace.min.js"></script>

  <!--plugins-->
  <link href="assets/plugins/perfect-scrollbar/css/perfect-scrollbar.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="assets/plugins/metismenu/metisMenu.min.css">
  <link rel="stylesheet" type="text/css" href="assets/plugins/metismenu/mm-vertical.css">
  <link rel="stylesheet" type="text/css" href="assets/plugins/simplebar/css/simplebar.css">
  <!--bootstrap css-->
  <link href="assets/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/plugins/datatable/css/dataTables.bootstrap5.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@300;400;500;600&amp;display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Material+Icons+Outlined" rel="stylesheet">
  <!--main css-->
  <link href="assets/css/bootstrap-extended.css" rel="stylesheet">
  <link href="sass/main.css" rel="stylesheet">
  <link href="sass/responsive.css" rel="stylesheet">

  <style>
    body {
      background-color: #182c25;
    }

    .table-responsive {
      overflow-x: auto;
      /* Ensure horizontal scrolling if needed */
    }

    .dataTables_wrapper .dataTables_paginate {
      float: right;
      margin-top: 10px;
    }

    /* Add some custom styles to make the table and pagination look better*/
    .table thead th {
      background-color: #005627 !important;
      /* Dark green header */
      color: white;
    }

    .table tbody td,
    .table tbody th {
      border: 1px solid #dee2e6;
      border-left: 1px solid #dee2e6;
      /* Lighter border */
    }

    .table tbody tr:nth-child(even) {
      background-color: #f2f2f2;
      /* Light gray background for even rows */
    }

    /* Existing CSS ... */

    .table-responsive {
      overflow-x: auto;
      width: 100%;
      /* Ensure table takes full available width */
    }

    .pagination {
      justify-content: center;
      margin-top: 15px;
      display: flex;
      /* Use flexbox for better control */
    }

    .pagination li {
      margin: 0 5px;
      /* Add spacing between pagination items */
    }

    .pagination .page-link {
      color: white;
      background-color: #343a40;
      border: 1px solid #ced4da;
      padding: 0.5rem 1rem;
      /* Adjust padding as needed */
      border-radius: 0.25rem;
      /* Round the corners */
    }

    .pagination .page-item.active .page-link {
      background-color: #005627 !important;
      border-color: #005627 !important;
    }

    .pagination .page-item.disabled .page-link {
      color: #6c757d;
      cursor: not-allowed;
      pointer-events: none;
    }

    .pagination .page-link:hover {
      background-color: #555;
    }

    table th:nth-child(2),
    .table td:nth-child(2) {
      max-width: 500px;
    }

    table th:nth-child(3),
    .table td:nth-child(3) {
      max-width: 200px;
    }

    /* Member ID */
    .table th:nth-child(4),
    .table td:nth-child(4) {
      max-width: 200px;
    }

    /* Name */
    .table th:nth-child(5),
    .table td:nth-child(5) {
      max-width: 200px;
    }

    /* Introducer */
    .table th:nth-child(6),
    .table td:nth-child(6) {
      max-width: 200px;
    }

    /* Referrals */
    .table th:nth-child(7),
    .table td:nth-child(7) {
      max-width: 200px;
    }

    /* Mobile */
    .table th:nth-child(8),
    .table td:nth-child(8) {
      max-width: 200px;
    }

    /* Status */
    .table th:nth-child(9),
    .table td:nth-child(9) {
      max-width: 200px;
    }

    /* Country */
    .table th:nth-child(10),
    .table td:nth-child(10) {
      max-width: 200px;
    }

    /* Email */
  </style>
</head>

<body>


  <!--start header-->
  <header class="top-header">
    <nav class="navbar navbar-expand align-items-center gap-4">
      <div class="btn-toggle">
        <a href="javascript:;"><i class="material-icons-outlined">menu</i></a>
      </div>
      <div class="search-bar flex-grow-1">
        <div class="position-relative">

          <div class="search-popup p-3">
            <div class="card rounded-4 overflow-hidden">
              <div class="card-body search-content">
              </div>
            </div>
          </div>
        </div>
      </div>
      <ul class="navbar-nav gap-1 nav-right-links align-items-center">

        <li class="nav-item dropdown">
          <a href="javascrpt:;" class="dropdown-toggle dropdown-toggle-nocaret" data-bs-toggle="dropdown">
            <img src="assets/images/Logo/avatar.png" class="rounded-circle p-1 border" width="45" height="45" alt="">
          </a>
          <div class="dropdown-menu dropdown-user dropdown-menu-end shadow">
            <a class="dropdown-item  gap-2 py-2" href="javascript:;">
              <div class="text-center">
                <img src="assets/images/logo/avatar.png" class="rounded-circle p-1 shadow mb-3" width="90" height="90"
                  alt="">
                <h5 class="user-name mb-0 fw-bold">Hello, Admin</h5>
              </div>
            </a>
            <hr class="dropdown-divider">
            <a class="dropdown-item d-flex align-items-center gap-2 py-2" href="edit company.html"><i
                class="material-icons-outlined">person_outline</i>Company Information</a>
            <a class="dropdown-item d-flex align-items-center gap-2 py-2" href="change password.html"><i
                class="material-icons-outlined">lock</i>Change Password</a>
            <hr class="dropdown-divider">
            <a class="dropdown-item d-flex align-items-center gap-2 py-2" href="login.html"><i
                class="material-icons-outlined">power_settings_new</i>Logout</a>
          </div>
        </li>
      </ul>

    </nav>
  </header>
  <!--end top header-->


  <!--start sidebar-->
  <aside class="sidebar-wrapper" data-simplebar="true">
    <div class="sidebar-header">
      <div class="logo-icon">
        <img src="assets/images/logo/avatar.png" style="width: 55px;" class="logo-img" alt="">
      </div>
      <div class="logo-name flex-grow-1">
        <h4 class="mb-0 text-light">AGHAN</h5>
      </div>
      <div class="sidebar-close">
        <span class="material-icons-outlined">close</span>
      </div>
    </div>
    <div class="sidebar-nav">
      <!--navigation-->
      <ul class="metismenu" id="sidenav">
        <li>
          <a href="index.html">
            <div class="parent-icon"><i class="material-icons-outlined">home</i>
            </div>
            <div class="menu-title">Dashboard</div>
          </a>
        </li>


        <li>
          <a href="javascript:;" class="has-arrow">
            <div class="parent-icon">
              <i class="material-icons-outlined">apartment</i>

            </div>
            <div class="menu-title">Company</div>
          </a>
          <ul>
            <li><a href="edit company.html"><i class="material-icons-outlined"></i>Edit Company</a></li>
            <li><a href="change password.html"><i class="material-icons-outlined"></i>Change Password</a>
            </li>
            <li>
              <a href="javascript:;" class="has-arrow">
                <i class="material-icons-outlined"></i>News
              </a>
              <ul>
                <li><a href="add news.html"><i class="material-icons-outlined"></i>Add News</a></li>
                <li><a href="edit news.html"><i class="material-icons-outlined"></i>Edit News</a></li>
              </ul>
            </li>
            <li>
              <a href="javascript:;" class="has-arrow">
                <i class="material-icons-outlined"></i>Bank
              </a>
              <ul>
                <li><a href="add bank.html"><i class="material-icons-outlined"></i>Add Bank</a></li>
                <li><a href="edit bank.html"><i class="material-icons-outlined"></i>Edit Bank</a></li>
              </ul>
            </li>
            <li>
              <a href="javascript:;" class="has-arrow">
                <i class="material-icons-outlined"></i>UPI
              </a>
              <ul>
                <li><a href="add upi.html"><i class="material-icons-outlined"></i>Add UPI</a></li>
                <li><a href="edit upi.html"><i class="material-icons-outlined"></i>Edit UPI</a></li>
              </ul>
            </li>
            <li>
              <a href="javascript:;" class="has-arrow">
                <i class="material-icons-outlined"></i>User Alerts
              </a>
              <ul>
                <li><a href="alert message.html"><i class="material-icons-outlined"></i>Alert Message</a>
                </li>
                <li><a href="alert history.html"><i class="material-icons-outlined"></i>Alert History</a>
                </li>
              </ul>
            </li>
          </ul>
        </li>

        <li>
          <a class="has-arrow" href="javascript:;">
            <div class="parent-icon"><i class="material-icons-outlined">event_note</i>
            </div>
            <div class="menu-title">Plans</div>
          </a>
          <ul>
            <li>
              <a href="javascript:;" class="has-arrow">
                <i class="material-icons-outlined"></i>Packages
              </a>
              <ul>
                <li><a href="add package.html"><i class="material-icons-outlined"></i>Add Package</a></li>
                <li><a href="package history.html"><i class="material-icons-outlined"></i>Package History</a>
                </li>
              </ul>
            </li>

            <li>
              <a href="javascript:;" class="has-arrow">
                <i class="material-icons-outlined"></i>Level Plan
              </a>
              <ul>
                <li><a href="level income update.html"><i class="material-icons-outlined"></i>Update</a></li>
                <li><a href="level income history.html"><i class="material-icons-outlined"></i>History</a>
                </li>
              </ul>
            </li>

            <li>
              <a href="javascript:;" class="has-arrow">
                <i class="material-icons-outlined"></i>Withdraw Deduction
              </a>
              <ul>
                <li><a href="withdraw deduction.html"><i class="material-icons-outlined"></i>Update</a></li>
                <li><a href="withdraw deduction history.html"><i class="material-icons-outlined"></i>History</a></li>
              </ul>
            </li>
          </ul>
        </li>

        <li>
          <a class="has-arrow" href="javascript:;">
            <div class="parent-icon"><i class="material-icons-outlined">groups</i>
            </div>
            <div class="menu-title">Members</div>
          </a>
          <ul>
            <li><a href="member list.html"><i class="material-icons-outlined"></i>Member List</a>
            </li>
            <li><a href="member filter.html"><i class="material-icons-outlined"></i>Members With Filter</a>
            </li>
          </ul>
        </li>

        <li>
          <a class="has-arrow" href="javascript:;">
            <div class="parent-icon"><i class="material-icons-outlined">device_hub</i>
            </div>
            <div class="menu-title">Genealogy</div>
          </a>
          <ul>
            <li><a href="tree view.html"><i class="material-icons-outlined"></i>Tree View</a>
            </li>
            <li><a href="my team.html"><i class="material-icons-outlined"></i>My Team View</a>
            </li>
            <li><a href="silver autofill.html"><i class="material-icons-outlined"></i>Silver Autofill</a>
            </li>
            <li><a href="gold autofill.html"><i class="material-icons-outlined"></i>Gold Autofill</a>
            </li>
            <li><a href="diamond autofill.html"><i class="material-icons-outlined"></i>Diamond Autofill</a>
            </li>
            <li><a href="platinum autofill.html"><i class="material-icons-outlined"></i>Platinum Autofill</a>
            </li>
            <li><a href="king autofill.html"><i class="material-icons-outlined"></i>King Autofill</a>
            </li>
          </ul>
        </li>

        <li>
          <a class="has-arrow" href="javascript:;">
            <div class="parent-icon"><i class="material-icons-outlined">monetization_on</i>
            </div>
            <div class="menu-title">Transactions</div>
          </a>
          <ul>
            <li>
              <a href="javascript:;" class="has-arrow">
                <i class="material-icons-outlined"></i>Add Fund
              </a>
              <ul>
                <li><a href="add fund.html"><i class="material-icons-outlined"></i>Add Fund</a></li>
                <li><a href="add fund history.html"><i class="material-icons-outlined"></i>Add Fund
                    History</a></li>
              </ul>
            </li>
            <li><a href="fund request pending.html"><i class="material-icons-outlined"></i>Fund Request
                Pending</a>
            </li>
            <li><a href="fund request approved.html"><i class="material-icons-outlined"></i>Fund Request
                Approved</a>
            </li>
            <li><a href="fund request rejected.html"><i class="material-icons-outlined"></i>Fund Request
                Rejected</a>
            </li>
            <li><a href="fund transfer history.html"><i class="material-icons-outlined"></i>Fund Transfer</a>
            </li>
          </ul>
        </li>

        <li>
          <a class="has-arrow" href="javascript:;">
            <div class="parent-icon"><i class="material-icons-outlined">wallet</i>
            </div>
            <div class="menu-title">Income</div>
          </a>
          <ul>
            <li><a href="sponsor income.html"><i class="material-icons-outlined"></i>Sponser Income</a>
            </li>
            <li><a href="level income.html"><i class="material-icons-outlined"></i>Level Income</a>
            </li>
            <li><a href="silver board income.html"><i class="material-icons-outlined"></i>Silver Board
                Income</a>
            </li>
            <li><a href="gold board income.html"><i class="material-icons-outlined"></i>Gold Board Income</a>
            </li>
            <li><a href="diamond board income.html"><i class="material-icons-outlined"></i>Diamond Board
                Income</a>
            </li>
            <li><a href="platinum board income.html"><i class="material-icons-outlined"></i>Platinum Board
                Income</a>
            </li>
            <li><a href="king board income.html"><i class="material-icons-outlined"></i>King Board Income</a>
            </li>
            <li><a href="payout.html"><i class="material-icons-outlined"></i>Payout</a>
            </li>
            <li><a href="unpaid income.html"><i class="material-icons-outlined"></i>Unpaid Income</a>
            </li>
            <li><a href="paid income.html"><i class="material-icons-outlined"></i>Paid Income</a>
            </li>
            <li><a href="reject income.html"><i class="material-icons-outlined"></i>Reject Income</a>
            </li>
          </ul>
        </li>


        <li>
          <a class="has-arrow" href="javascript:;">
            <div class="parent-icon"><i class="material-icons-outlined">card_giftcard</i>
            </div>
            <div class="menu-title">Achievers</div>
          </a>
          <ul>
            <li><a href="undelivered achievers.html"><i class="material-icons-outlined"></i>Undelivered
                Achievers</a>
            </li>
            <li><a href="delivered achievers.html"><i class="material-icons-outlined"></i>Delivered
                Achievers</a>
            </li>
          </ul>
        </li>

        <li>
          <a href="user log.html">
            <div class="parent-icon"><i class="material-icons-outlined">account_circle</i>
            </div>
            <div class="menu-title">User Log</div>
          </a>
        </li>

        <li>
          <a class="has-arrow" href="javascript:;">
            <div class="parent-icon"><i class="material-icons-outlined">support_agent</i>
            </div>
            <div class="menu-title">Support</div>
          </a>
          <ul>
            <li><a href="pending tickets.html"><i class="material-icons-outlined"></i>Pending Tickets</a>
            </li>
            <li><a href="closed tickets.html"><i class="material-icons-outlined"></i>Closed Tickets</a>
            </li>
          </ul>
        </li>

        <li>
          <a href="login.html">
            <div class="parent-icon"><i class="material-icons-outlined">logout</i>
            </div>
            <div class="menu-title">Sign Out</div>
          </a>
        </li>
      </ul>
      <!--end navigation-->
    </div>
  </aside>
  <!--end sidebar-->

  <!--start main wrapper-->
  <main class="main-wrapper">
    <div class="main-content">
      <!--breadcrumb-->
      <div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
        <div class="breadcrumb-title text-light pe-3">Member List</div>
      </div>
      <p class="text-light">You Can View Member List Here.</p>
      <!--end breadcrumb-->

      <style>
        .card {
          background-color: #005627 !important;
        }

        .table>:not(caption)>*>* {
          background-color: #005627 !important;
          color: #fff;
        }

        .table-bordered td,
        .table-bordered th {
          border: 2px solid #fff;
        }

        .search-container {
          position: relative;
        }

        .search-input {
          height: 30px;
          width: 150px;
          padding-right: 30px;
        }


        .clear-icon {
          position: absolute;
          right: 10px;
          top: 50%;
          transform: translateY(-50%);
          cursor: pointer;
          display: none;
        }
      </style>

      <hr>
      <div class="card">
        <div class="card-body">
          <div class="d-flex justify-content-between mb-3">
            <div class="search-container">
              <input type="text" class="form-control search-input" id="searchInput" placeholder="Type to Search..">
              <i id="clearIcon" class="fas fa-times clear-icon"></i>
            </div>

            <link rel="stylesheet"
              href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
            <div class="d-flex align-items-center">
              <select class="custom-select" id="rowCountSelect"
                style="width: auto; border-radius: 5px; border: 1px solid #ced4da;">
                <option value="10" selected>10</option>
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="100">100</option>
              </select>
            </div>
          </div>
          <div class="table-responsive">
            <strong>
              <table id="memberTable" style="text-align: center;" class="table table-bordered">
                <thead>
                  <tr>
                    <th scope="col">S.NO</th>
                    <th scope="col">Action</th>
                    <th scope="col">Member ID</th>
                    <th scope="col">Name</th>
                    <th scope="col">Introducer</th>
                    <th scope="col">Mobile</th>
                    <th scope="col">Pass</th>
                    <th scope="col">S.Pass</th>
                    <th scope="col">Status</th>
                    <th scope="col">Country</th>
                    <th scope="col">Email</th>
                    <th scope="col">Date of Join</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
                <tfoot>
                  <tr>
                    <td colspan="13"> <!-- Adjust colspan as needed -->
                      <nav aria-label="Page navigation example">
                        <ul class="pagination" id="pagination"></ul>
                      </nav>
                    </td>
                  </tr>
                </tfoot>
              </table>
            </strong>
          </div>
        </div>
      </div>
    </div>
  </main>
  <!--end main wrapper-->


  <!-- Modal Start -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body">
          <div class="row">
            <!-- Hamburger button for mobile view -->
            <div class="d-md-none mb-3 d-flex justify-content-end">
              <button class="btn" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar"
                aria-controls="offcanvasSidebar" style="background-color: green;">
                <!-- Custom 3-line icon (Hamburger menu) -->
                <div style="width: 24px; height: 2px; background-color: white; margin: 4px 0;"></div>
                <div style="width: 24px; height: 2px; background-color: white; margin: 4px 0;"></div>
                <div style="width: 24px; height: 2px; background-color: white; margin: 4px 0;"></div>
              </button>
            </div>


            <!-- Sidebar Navigation (Offcanvas for mobile) -->
            <div class="offcanvas offcanvas-start d-md-none" tabindex="-1" id="offcanvasSidebar"
              aria-labelledby="offcanvasSidebarLabel" style="width: 320px;">
              <div class="offcanvas-header">
                <div style="display: flex; align-items: center;">
                  <img src="./assets/images/Logo/avatar.png" style="width: 40px; margin-right: 10px;">
                  <div>
                    <p style="margin: 0;" id="sidebar-name"><b>NEWRAJA S150</b></p>
                    <p style="margin: 0;" id="sidebar-email">new_raja87@yahoo.com</p>
                  </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
              </div>
              <hr>
              <div class="offcanvas-body">
                <div>
                  <h6>Wallet Account</h6>
                  <h5 class="text-warning" id="sidebar-wallet">Rs. 0.00</h5>
                  <p id="sidebar-lock">Locked</p>
                </div>
                <hr>
                <ul class="nav flex-column nav-pills" id="wizardSidebarMobile" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" id="personal-info-tab" data-bs-toggle="pill" href="#personal-info"
                      role="tab" aria-controls="personal-info" aria-selected="true">Personal Information</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="address-info-tab" data-bs-toggle="pill" href="#address-info" role="tab"
                      aria-controls="address-info" aria-selected="true">Address</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="change-password-tab" data-bs-toggle="pill" href="#change-password"
                      role="tab" aria-controls="change-password" aria-selected="false">Change Password</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="update-bank-tab" data-bs-toggle="pill" href="#update-bank" role="tab"
                      aria-controls="update-bank" aria-selected="false">Update Bank</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="update-upi-tab" data-bs-toggle="pill" href="#update-upi" role="tab"
                      aria-controls="update-upi" aria-selected="false">Update UPI</a>
                  </li>
                </ul>
              </div>
            </div>

            <style>
              .nav-pills .nav-link.active {
                background-color: #005627 !important;
              }
            </style>
            <!-- Sidebar for desktop view -->
            <div class="col-md-3 d-none d-md-block">
              <div style="display: flex; align-items: center;">
                <img src="./assets/images/Logo/avatar.png" style="width: 40px; margin-right: 10px;">
                <div id="desktop-view">
                  <p style="margin: 0; font-size: .9rem;" id="sidebar-name"><b>NEWRAJA S150</b></p>
                  <p style="margin: 0;font-size: .6rem;" id="sidebar-email">new_raja87@yahoo.com</p>
                </div>
              </div>
              <hr>
              <div id="desktop-view">
                <h6>Wallet Account</h6>
                <h5 class="text-warning" id="sidebar-wallet">Rs. 0.00</h5>
                <p id="sidebar-lock">Locked Rs. 0</p>
              </div>
              <hr>
              <ul class="nav flex-column nav-pills" id="wizardSidebar" role="tablist">
                <li class="nav-item">
                  <a class="nav-link active" id="personal-info-tab" data-bs-toggle="pill" href="#personal-info"
                    role="tab" aria-controls="personal-info" aria-selected="true">Personal Information</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="address-info-tab" data-bs-toggle="pill" href="#address-info" role="tab"
                    aria-controls="address-info" aria-selected="true">Address</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="change-password-tab" data-bs-toggle="pill" href="#change-password" role="tab"
                    aria-controls="change-password" aria-selected="false">Change Password</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="update-bank-tab" data-bs-toggle="pill" href="#update-bank" role="tab"
                    aria-controls="update-bank" aria-selected="false">Update Bank</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="update-upi-tab" data-bs-toggle="pill" href="#update-upi" role="tab"
                    aria-controls="update-upi" aria-selected="false">Update UPI</a>
                </li>
              </ul>
            </div>

            <!-- Tab Content -->
            <div class="col-md-9">
              <div class="tab-content" id="wizardContent">

                <!-- Personal Information Tab -->
                <div class="tab-pane fade show active" id="personal-info" role="tabpanel"
                  aria-labelledby="personal-info-tab">
                  <h5><b>Personal Information</b></h5>
                  <br>
                  <form id="profileForm" class="row g-3">
                    <input type="hidden" id="userId" name="userId">
                    <div class="col-md-6">
                      <label for="fullname" class="form-label">Full Name</label>
                      <input type="text" class="form-control" id="fullname" value="NEWRAJA S150"
                        placeholder="ENTER FULL NAME">
                    </div>
                    <div class="col-md-6">
                      <label for="email" class="form-label">E-Mail</label>
                      <input type="email" class="form-control" id="email" value="new_raja87@yahoo.com"
                        placeholder="ENTER E-MAIL">
                    </div>
                    <div class="col-md-6">
                      <label for="Phone" class="form-label">Phone Number</label>
                      <input type="number" class="form-control" id="Phone" value="09751417940"
                        placeholder="ENTER PHONE NUMBER">
                    </div>
                    <div class="col-md-6">
                      <label for="Aadhaar" class="form-label">Aadhaar Number</label>
                      <input type="text" class="form-control" id="Aadhaar" value="987654321021"
                        placeholder="ENTER AADHAAR NUMBER">
                    </div>
                    <div class="col-md-6">
                      <label for="PAN" class="form-label">PAN Number</label>
                      <input type="text" class="form-control" id="PAN" value="ABCD12345" placeholder="ENTER PAN Number">
                    </div>
                    <div class="d-flex justify-content-center col-md-12">
                      <button type="submit" data-form-id="profile" class="btn btn-success btn-md me-2">Update
                        Profile</button>
                      <button type="button" class="btn btn-dark btn-md" data-bs-dismiss="modal">Close</button>
                    </div>
                  </form>
                </div>



                <!-- Address Information Tab -->
                <div class="tab-pane fade show" id="address-info" role="tabpanel" aria-labelledby="address-info-tab">
                  <h5><b>Address Information</b></h5>
                  <br>
                  <form id="addressForm" class="row g-3">
                    <div class="col-md-6">
                      <label for="address" class="form-label">Address</label>
                      <input type="text" class="form-control" id="address" placeholder="ENTER ADDRESS">
                    </div>
                    <div class="col-md-6">
                      <label for="Street" class="form-label">Street</label>
                      <input type="text" class="form-control" id="Street" placeholder="ENTER STREET">
                    </div>
                    <div class="col-md-6">
                      <label for="CITY" class="form-label">City</label>
                      <input type="text" class="form-control" id="CITY" placeholder="ENTER CITY">
                    </div>
                    <div class="col-md-6">
                      <label for="STATE" class="form-label">State</label>
                      <input type="text" class="form-control" id="STATE" placeholder="ENTER STATE">
                    </div>
                    <div class="col-md-6">
                      <label for="country" class="form-label">Country</label>
                      <input type="text" class="form-control" id="country" placeholder="ENTER COUNTRY">
                    </div>
                    <div class="col-md-6">
                      <label for="PINCODE" class="form-label">Pincode</label>
                      <input type="text" class="form-control" id="PINCODE" placeholder="ENTER PINCODE">
                    </div>
                    <div class="d-flex justify-content-center col-md-12">
                      <button type="submit" data-form-id="address" class="btn btn-success btn-md me-2">Update
                        Address</button>
                      <button type="button" class="btn btn-dark btn-md" data-bs-dismiss="modal">Close</button>
                    </div>
                  </form>

                </div>



                <!-- Change Password Tab -->
                <div class="tab-pane fade" id="change-password" role="tabpanel" aria-labelledby="change-password-tab">
                  <h5><b>Change Password</b></h5>
                  <br>
                  <form id="change-password-form" class="row g-3">
                    <h5><b class="text-success">Password</b></h5>
                    <div class="col-md-6">
                      <label for="newPassword" class="form-label">Enter New Password</label>
                      <div class="input-group">
                        <input type="password" class="form-control" id="newpassword"
                          placeholder="Enter Your New Password">
                        <span class="input-group-text" id="toggle-newpassword" style="cursor: pointer;">
                          <i class="material-icons-outlined fs-5">visibility</i>
                        </span>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <label for="confirmPassword" class="form-label">Confirm Password</label>
                      <input type="password" class="form-control" id="confirmPassword"
                        placeholder="Enter Confirm Password">
                    </div>

                    <br><br><br><br><br><br>

                    <h5><b class="text-success">Transaction Password</b></h5>

                    <div class="col-md-6">
                      <label for="newtransactionpassword" class="form-label">Enter New Password</label>
                      <div class="input-group">
                        <input type="password" class="form-control" id="newtransactionpassword"
                          placeholder="Enter New Transaction Password">

                        <span class="input-group-text" id="toggle-transactionpassword" style="cursor: pointer;">
                          <i class="material-icons-outlined fs-5">visibility</i>
                        </span>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <label for="confirmtransactionpassword" class="form-label">Confirm Password</label>
                      <input type="password" class="form-control" id="confirmtransactionpassword"
                        placeholder="Enter Confirm Transaction Password">
                    </div>

                    <div class="d-flex justify-content-center col-md-12">
                      <button type="submit" class="btn btn-success btn-md me-2">Update Password</button>
                      <button type="button" class="btn btn-dark btn-md" data-bs-dismiss="modal">Close</button>
                    </div>
                  </form>
                </div>


                <!-- Update Bank Tab -->
                <div class="tab-pane fade" id="update-bank" role="tabpanel" aria-labelledby="update-bank-tab">
                  <h5><b>Update Bank Details</b></h5>
                  <br>
                  <form id="update-bank" class="row g-3">

                    <div class="col-md-6">
                      <label for="accountholdername" class="form-label">Account Holder Name</label>
                      <input type="text" class="form-control" id="accountholdername"
                        placeholder="Enter Account Holder Name">
                    </div>

                    <div class="col-md-6">
                      <label for="accountNumber" class="form-label">Account Number</label>
                      <input type="number" class="form-control" id="accountNumber" placeholder="Enter Account Number">
                    </div>
                    <div class="col-md-6">
                      <label for="bankName" class="form-label">Bank Name</label>
                      <input type="text" class="form-control" id="bankName" placeholder="Enter Bank Name">
                    </div>

                    <div class="col-md-6">
                      <label for="ifscCode" class="form-label">IFSC Code</label>
                      <input type="text" class="form-control" id="ifscCode" placeholder="Enter IFSC Code">
                    </div>

                    <div class="col-md-6">
                      <label for="bankBranch" class="form-label">Bank Branch</label>
                      <input type="text" class="form-control" id="bankBranch" placeholder="Enter Bank Branch">
                    </div>

                    <div class="d-flex justify-content-center col-md-12">
                      <button type="submit" class="btn btn-success btn-md me-2">Update Bank</button>
                      <button type="button" class="btn btn-dark btn-md" data-bs-dismiss="modal">Close</button>
                    </div>
                  </form>

                </div>

                <!-- Update UPI Tab -->
                <div class="tab-pane fade" id="update-upi" role="tabpanel" aria-labelledby="update-upi-tab">
                  <h5><b>Update UPI Details</b></h5>
                  <br>
                  <form id="update-upi" class="row g-3">
                    <div class="col-md-12">
                      <label for="googlepay" class="form-label">Google Pay</label>
                      <input type="number" class="form-control" id="googlepay"
                        placeholder="Enter your Google Pay Number">
                    </div>

                    <div class="col-md-12">
                      <label for="phonepe" class="form-label">PhonePe</label>
                      <input type="number" class="form-control" id="Phonepe" placeholder="Enter your PhonePe Number">
                    </div>

                    <div class="col-md-12">
                      <label for="PayTm" class="form-label">PayTm</label>
                      <input type="number" class="form-control" id="PayTm" placeholder="Enter your PayTm Number">
                    </div>

                    <div class="d-flex justify-content-center col-md-12">
                      <button type="submit" class="btn btn-success btn-md me-2">Update UPI's</button>
                      <button type="button" class="btn btn-dark btn-md" data-bs-dismiss="modal">Close</button>
                    </div>
                  </form>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Close sidebar after clicking a link on mobile
    document.querySelectorAll('#wizardSidebarMobile a').forEach(link => {
      link.addEventListener('click', function () {
        let offcanvasSidebar = document.querySelector('#offcanvasSidebar');
        let bsOffcanvas = bootstrap.Offcanvas.getInstance(offcanvasSidebar);
        bsOffcanvas.hide();
      });
    });
  </script>

  <script>
    document.getElementById('toggle-newpassword').addEventListener('click', function () {
      var input = document.getElementById('newpassword');
      var icon = this.querySelector('i');

      if (input.type === "password") {
        input.type = "text";
        icon.textContent = 'visibility_off';
      } else {
        input.type = "password";
        icon.textContent = 'visibility';
      }
    });



    document.getElementById('toggle-transactionpassword').addEventListener('click', function () {
      var input = document.getElementById('newtransactionpassword');
      var icon = this.querySelector('i');

      if (input.type === "password") {
        input.type = "text";
        icon.textContent = 'visibility_off';
      } else {
        input.type = "password";
        icon.textContent = 'visibility';
      }
    });
  </script>

  <!-- Modal End -->




  <!--start overlay-->
  <div class="overlay btn-toggle"></div>
  <!--end overlay-->


  <!--bootstrap js-->
  <script src="assets/js/bootstrap.bundle.min.js"></script>

  <!--plugins-->
  <script src="assets/js/jquery.min.js"></script>
  <!--plugins-->
  <script src="assets/plugins/perfect-scrollbar/js/perfect-scrollbar.js"></script>
  <script src="assets/plugins/metismenu/metisMenu.min.js"></script>
  <script src="assets/plugins/datatable/js/jquery.dataTables.min.js"></script>
  <script src="assets/plugins/datatable/js/dataTables.bootstrap5.min.js"></script>

  <script src="assets/plugins/simplebar/js/simplebar.min.js"></script>
  <script src="assets/js/main.js"></script>
  <script>
    const token = sessionStorage.getItem('token');
    if (!token) {
      window.location.href = 'login.html';
    }
    $(document).ready(function () {
      let currentPage = 1;
      let pageSize = 10;
      let totalCount = 0;
      let searchTerm = '';

      function loadMembers() {
        console.log("currentPage:", currentPage);
        console.log("pageSize:", pageSize);
        const token = sessionStorage.getItem('token'); //Ensure you have token handling correctly
        if (!token) {
          alert('You are not logged in. Please login to view members.');
          return;
        }
        $.ajax({
          url: 'https://aghan-backend-fbs2.vercel.app/memberList',
          type: 'GET',
          headers: {
            'Authorization': `Bearer ${token}`
          },
          data: { page: currentPage, pageSize: pageSize, search: searchTerm },
          success: function (response) {
            $('#memberTable tbody').empty();
            let sno = (currentPage - 1) * pageSize + 1;
            totalCount = response.totalCount;
            response.members.forEach(member => {
              const actionButtons = `
    <div>
        <a class="text-warning edit-btn" href="#" data-user-id="${member.user_id}"><i class="fas fa-edit"></i> Edit</a> /
        <a class="text-success login-btn" href="#" data-user-id="${member.user_id}" data-password="${member.password}" data-lock="${member.lock_status}"><i class="fas fa-sign-in-alt"></i> Login</a> /
        <a class="withdrawal-lock-btn ${member.withdrawal_lock_status ? 'text-success' : 'text-danger'}" href="#" data-user-id="${member.user_id}" data-lock-status="${member.withdrawal_lock_status}"><i class="fas fa-lock"></i> ${member.withdrawal_lock_status ? 'W.Unlock' : 'W.Lock'}</a>/
        <a class="lock-btn ${member.lock_status ? 'text-success' : 'text-danger'}" href="#" data-user-id="${member.user_id}" data-lock-status="${member.lock_status}"><i class="fas fa-lock"></i> ${member.lock_status ? 'Unlock' : 'Lock'}</a> 
        
    </div>
`;
              $('#memberTable tbody').append(`
                        <tr>
                            <td>${sno++}</td>
                            <td>${actionButtons}</td>
                            <td>${member.user_id}</td>
                            <td>${member.username}</td>
                            <td>${member.introducer_id || ''}</td>
                            <td>${member.mobile || ''}</td>
                            <td>${member.password || ''}</td>
                            <td>${member.transaction_password || ''}</td>
                            <td>${member.status || ''}</td>
                            <td>${member.country || ''}</td>
                            <td>${member.email || ''}</td>
                            <td>${member.created_at}</td>
                        </tr>
                    `);
            });
            updatePagination(response.currentPage, response.pageSize, totalCount);
          },
          error: function (error) {
            console.error('Error:', error);
            const errorMessage = error.responseJSON ? error.responseJSON.message : error.statusText;
            alert(`Failed to load members: ${errorMessage}`);
          }
        });
      }

      function updatePagination(currentPage, pageSize, totalCount) {
        const totalPages = Math.ceil(totalCount / pageSize);
        $('#pagination').empty();

        if (totalPages > 0) {
          // Previous button
          const prevClass = currentPage <= 1 ? 'disabled' : '';
          $('#pagination').append(`<li class="page-item ${prevClass}"><a class="page-link" href="#" data-page="${currentPage - 1}">Previous</a></li>`);

          // Page numbers
          for (let i = 1; i <= totalPages; i++) {
            const activeClass = i === currentPage ? 'active' : '';
            $('#pagination').append(`<li class="page-item ${activeClass}"><a class="page-link" href="#" data-page="${i}">${i}</a></li>`);
          }

          // Next button
          const nextClass = currentPage >= totalPages ? 'disabled' : '';
          $('#pagination').append(`<li class="page-item ${nextClass}"><a class="page-link" href="#" data-page="${currentPage + 1}">Next</a></li>`);
        }
      }


      //Attach pagination event handler ONLY ONCE.  This is crucial!
      $('#pagination').on('click', '.page-link', function (event) {
        event.preventDefault();
        const newPage = parseInt($(this).data('page'), 10);
        if (!isNaN(newPage) && newPage >= 1 && newPage <= Math.ceil(totalCount / pageSize)) {
          currentPage = newPage;
          loadMembers();
        }
      });

      $("#searchInput").keyup(function () {
        searchTerm = $(this).val();
        currentPage = 1;
        loadMembers();
      });

      $('#rowCountSelect').change(function () {
        pageSize = parseInt($(this).val());
        currentPage = 1;
        loadMembers();
      });

      loadMembers();

      function updateLockStatus(userId, lockType) {
        $.ajax({
          url: `https://aghan-backend-fbs2.vercel.app/lock-${lockType}/${userId}`,
          type: 'PUT',
          headers: {
            'Authorization': `Bearer ${sessionStorage.getItem('token')}`
          },
          contentType: 'application/json',
          success: function (data) {
            alert(data.message);
            // Reload the member list after a successful update
            loadMembers();
          },
          error: function (error) {
            console.error('Error updating lock status:', error);
            const errorMessage = error.responseJSON ? error.responseJSON.message : error.statusText;
            alert(`Error: ${errorMessage}`);
          }
        });
      }

      function populateSidebar(userData) {
        console.log("userData:", userData); // Check if userData is populated correctly
        console.log("sidebar-name element:", $('#wizardSidebar #sidebar-name'));
        $('#offcanvasSidebar #sidebar-name').text(userData.username);
        $('#offcanvasSidebar #sidebar-email').text(userData.email);
        $('#offcanvasSidebar #sidebar-wallet').text(`Rs. ${userData.fund_income}/-`);
        $('#offcanvasSidebar #sidebar-lock').text(userData.lock_status ? "Locked" : "");
        $('#desktop-view #sidebar-name').text(userData.username);
        $('#desktop-view #sidebar-email').text(userData.email);
        $('#desktop-view #sidebar-wallet').text(`Rs. ${userData.fund_income}/-`);
        $('#desktop-view #sidebar-lock').text(userData.lock_status ? "Locked" : "");
      }

      $('#memberTable').on('click', '.lock-btn', function () {
        const userId = $(this).data('user-id');
        updateLockStatus(userId, 'account');
      });

      $('#memberTable').on('click', '.withdrawal-lock-btn', function () {
        const userId = $(this).data('user-id');
        updateLockStatus(userId, 'withdrawal');
      });

      function fetchUserData(userId) {
        return $.ajax({
          url: `https://aghan-backend-fbs2.vercel.app/users/${userId}`,
          type: 'GET',
          headers: {
            'Authorization': `Bearer ${sessionStorage.getItem('token')}`
          },
          error: function (jqXHR, textStatus, errorThrown) {
            console.error('Error fetching user data:', errorThrown);
            // Handle errors more specifically, e.g., show user-friendly messages based on HTTP status
            const statusCode = jqXHR.status;
            if (statusCode === 404) {
              alert('User not found.');
            } else {
              alert('Failed to fetch user details. Please try again later.');
            }
          }
        });
      }

      async function fetchUPIDetails(userId) {
        try {
          const response = await fetch(`https://aghan-backend-fbs2.vercel.app/upi-details/${userId}`, {
            headers: {
              'Authorization': `Bearer ${sessionStorage.getItem('token')}`
            }
          });

          if (!response.ok) {
            if (response.status === 404) {
              return null; // No UPI details found
            }
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return await response.json();

        } catch (error) {
          console.error('Error fetching UPI details:', error);
          alert('Failed to fetch UPI details.');
          return null;
        }
      }

      // Attach event handler to the table (event delegation).  This is more efficient.
      $('#memberTable').on('click', '.edit-btn', async function (event) {
        event.preventDefault();
        const userId = $(this).data('user-id');

        fetchUserData(userId)
          .then(userData => {
            // Populate the modal form with user data
            $('#fullname').val(userData.username);
            $('#email').val(userData.email);
            $('#Phone').val(userData.mobile);
            $('#address').val(userData.address);
            $('#Street').val(userData.street);
            $('#CITY').val(userData.city);
            $('#STATE').val(userData.state);
            $('#country').val(userData.country);
            $('#PINCODE').val(userData.zipcode);
            $('#Aadhaar').val(userData.aadhaar_number);
            $('#PAN').val(userData.pan_number);
            $('#userId').val(userId);

            const bankData = fetchBankDetails(userId);
            if (bankData) {
              $('#accountholdername').val(bankData.account_holder_name);
              $('#accountNumber').val(bankData.account_number);
              $('#bankName').val(bankData.bank_name);
              $('#ifscCode').val(bankData.bank_ifsc);
              $('#bankBranch').val(bankData.bank_branch);
            }

            fetchUPIDetails(userId).then(upiDetails => {
              if (upiDetails) {
                $('#googlepay').val(upiDetails.googlepay);
                $('#Phonepe').val(upiDetails.phonpe);
                $('#PayTm').val(upiDetails.paytm);
              }
            }).catch(error => {
              console.error("Error fetching UPI details:", error);
            });


            populateSidebar(userData);

            $('#exampleModal').modal('show');
          })
          .catch(error => {
            console.error("Error fetching user data:", error); //Error message
          });
      });

      $('#memberTable').on('click', '.login-btn', function (event) {
        event.preventDefault();
        const userId = $(this).data('user-id');
        const password = $(this).data('password');
        const lockStatus = $(this).data('lock');

        if (lockStatus) {
          alert('This user is locked. Cannot login.');
          return; // Stop execution if locked
        }

        loginFunction(userId, password);
      });

      async function loginFunction(userId, password) {
        try {
          const response = await fetch('https://aghan-backend-fbs2.vercel.app/login', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ id: userId, password })
          });

          if (!response.ok) {
            if (response.status === 401) {
              throw new Error('Incorrect username or password.');
            } else {
              const errorData = await response.json();
              throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
            }
          }

          const data = await response.json();
          if (data.success) {
            const token = data.token;
            const targetUrl = `https://aghan-user.vercel.app/user.html?token=${encodeURIComponent(token)}`;
            window.open(targetUrl, '_blank');
          }

        } catch (error) {
          console.error('Login error:', error);
        }
      }

      async function updateUser(userId, data, apiUrl) {
        const token = sessionStorage.getItem('token');
        if (!token) {
          alert('You are not logged in.');
          return;
        }
        try {
          const response = await fetch(apiUrl, {
            method: 'PUT',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify(data)
          });

          if (!response.ok) {
            const errorData = await response.json();
            const errorMessage = errorData.error || `HTTP error! status: ${response.status}`;
            throw new Error(errorMessage);
          }
          const result = await response.json();
          alert(result.message);
          loadMembers(); // Reload the member list
        } catch (error) {
          console.error('Error updating user:', error);
          alert(`Failed to update user: ${error.message}`);
        }
      }


      // Event handler for profile form submission
      $('#profileForm').on('submit', async function (e) {
        e.preventDefault();
        const userId = $('#userId').val();
        const profileData = {
          username: $('#fullname').val(),
          email: $('#email').val(),
          mobile: $('#Phone').val(),
          aadhaar_number: $('#Aadhaar').val(),
          pan_number: $('#PAN').val()
        };

        await updateUser(userId, profileData, `https://aghan-backend-fbs2.vercel.app/update-profile/${userId}`);
      });

      async function fetchBankDetails(userId) {
        try {
          const response = await fetch(`https://aghan-backend-fbs2.vercel.app/bank-details/${userId}`, {
            headers: {
              'Authorization': `Bearer ${sessionStorage.getItem('token')}`
            }
          });

          if (!response.ok) {
            if (response.status === 404) {
              return null; //No bank details found
            }
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return await response.json();

        } catch (error) {
          console.error('Error fetching bank details:', error);
          alert('Failed to fetch bank details.');
          return null; //Return null to indicate fetch failure
        }
      }
      // Event handler for address form submission
      $('#addressForm').on('submit', async function (e) {
        e.preventDefault();
        const userId = $('#userId').val();
        const addressData = {
          address: $('#address').val(),
          street: $('#Street').val(),
          city: $('#CITY').val(),
          state: $('#STATE').val(),
          country: $('#country').val(),
          pincode: $('#PINCODE').val()
        };

        await updateUser(userId, addressData, `https://aghan-backend-fbs2.vercel.app/update-address/${userId}`);
      });

      $('#change-password form').on('submit', async function (e) {
        e.preventDefault();
        const userId = $('#userId').val();
        const passwordData = {
          newPassword: $('#newpassword').val(),
          confirmPassword: $('#confirmPassword').val(),
          newTransactionPassword: $('#newtransactionpassword').val(),
          confirmTransactionPassword: $('#confirmtransactionpassword').val()
        };

        //Make an AJAX call to update the user's data
        $.ajax({
          url: `https://aghan-backend-fbs2.vercel.app/update-password/${userId}`,
          type: 'PUT',
          headers: {
            'Authorization': `Bearer ${sessionStorage.getItem('token')}`,
            'Content-Type': 'application/json'
          },
          data: JSON.stringify(passwordData),
          success: function (response) {
            $('#exampleModal').modal('hide');
            alert(response.message);
            loadMembers(); //Reload the member list after updating
          },
          error: function (error) {
            console.error("Error updating password:", error)
            alert("Error updating password. Please check your input."); //More user-friendly error message
          }
        });
      });
      $('#update-upi form').on('submit', async function (e) {
        e.preventDefault();
        const userId = $('#userId').val();
        const upiData = {
          googlepay: $('#googlepay').val(),
          phonpe: $('#Phonepe').val(),
          paytm: $('#PayTm').val()
        };

        // Input Validation (Add more robust validation as needed)
        if (!upiData.googlepay && !upiData.phonpe && !upiData.paytm) {
          alert('Please enter at least one UPI number.');
          return;
        }

        const phoneRegex = /^\d{10}$/; // Adjust regex as needed
        if (upiData.googlepay && !phoneRegex.test(upiData.googlepay)) {
          alert('Invalid Google Pay number.');
          return;
        }
        if (upiData.phonpe && !phoneRegex.test(upiData.phonpe)) {
          alert('Invalid PhonePe number.');
          return;
        }
        if (upiData.paytm && !phoneRegex.test(upiData.paytm)) {
          alert('Invalid PayTM number.');
          return;
        }

        try {
          const response = await fetch(`https://aghan-backend-fbs2.vercel.app/upi-details/${userId}`, { // Correct API endpoint
            method: 'PUT',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${sessionStorage.getItem('token')}`
            },
            body: JSON.stringify(upiData)
          });

          if (response.ok) {
            const result = await response.json();
            alert(result.message);
            $('#exampleModal').modal('hide');
            loadMembers(); // Reload member list
          } else {
            const errorData = await response.json();
            alert(`Error updating UPI details: ${errorData.error || 'An unknown error occurred.'}`);
          }
        } catch (error) {
          console.error('Error updating UPI details:', error);
          alert('Failed to update UPI details.');
        }
      });

      $('#update-bank form').on('submit', async function (e) {
        e.preventDefault();
        const userId = $('#userId').val();
        const bankData = {
          account_holder_name: $('#accountholdername').val(),
          account_number: $('#accountNumber').val(),
          bank_name: $('#bankName').val(),
          bank_ifsc: $('#ifscCode').val(),
          bank_branch: $('#bankBranch').val()
        };

        // Fetch bank details before updating
        fetch(`https://aghan-backend-fbs2.vercel.app/bank-details/${userId}`, {
          headers: {
            'Authorization': `Bearer ${sessionStorage.getItem('token')}`
          }
        })
          .then(response => {
            if (response.ok) {
              return response.json();
            }
            throw new Error(`HTTP error! status: ${response.status}`);
          })
          .then(data => {
            bankData.account_id = data.account_id; // Add account_id to data for update.
            updateBankDetails(userId, bankData);
          })
          .catch(error => {
            console.error("Error:", error);
            alert("Failed to fetch bank details");
          });
      });

      async function updateBankDetails(userId, bankData) {
        try {
          const response = await fetch(`https://aghan-backend-fbs2.vercel.app/bank-details/${userId}`, {
            method: 'PUT',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${sessionStorage.getItem('token')}`
            },
            body: JSON.stringify(bankData)
          });

          if (response.ok) {
            const result = await response.json();
            alert(result.message);
            $('#exampleModal').modal('hide');
            loadMembers(); // Reload the member list after updating
          } else {
            const errorData = await response.json();
            alert(`Error updating bank details: ${errorData.error || 'An unknown error occurred.'}`);
          }
        } catch (error) {
          console.error('Error updating bank details:', error);
          alert('Failed to update bank details.');
        }
      }

    });

  </script>

</body>

</html>